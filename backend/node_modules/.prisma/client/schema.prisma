generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model User {
  id        String       @id @default(cuid())
  email     String       @unique
  username  String       @unique
  password  String // hashed
  createdAt DateTime     @default(now())
  ratings   GameRating[]
}

// each swipe / wishlist / star rating the user leaves
model GameRating {
  id String @id @default(cuid())

  user   User   @relation(fields: [userId], references: [id])
  userId String

  // which game this refers to (IGDB id)
  gameId Int

  // snapshot display data for this game at the moment we rated it
  title       String
  coverImage  String?
  platforms   String? // "PC, PS5, Switch"
  genres      String? // "Action, RPG"
  releaseYear Int?

  // user's opinion
  stars  Int? // 1-5 if rated, null if wishlist only
  status String // 'rated' | 'wishlist'

  createdAt DateTime @default(now())

  // make this optional
  Game Game? @relation(fields: [gameId], references: [id])

  // a user can't have two separate entries for the same game
  @@unique([userId, gameId], name: "userId_gameId")
}

model Game {
  id          Int          @id // IGDB game id
  title       String
  coverImage  String?
  releaseYear Int?
  platforms   String? // "PC,PS5,Switch"
  genres      String? // "Action,RPG"
  ratings     GameRating[]
}
